{
	"id": "org.freedesktop.Sdk.Extension.php74",
	"branch": "19.08",
	"runtime": "org.freedesktop.Sdk",
	"sdk": "org.freedesktop.Sdk",
	"runtime-version": "19.08",
	"sdk-extensions": [],
	"build-extension": true,
	"separate-locales": false,
	"appstream-compose": false,
	"cleanup": [
		"/bin/argon2",
		"/bin/clusterdb",
		"/bin/createdb",
		"/bin/createuser",
		"/bin/dropdb",
		"/bin/dropuser",
		"/bin/ecpg",
		"/bin/initdb",
		"/bin/ldap*",
		"/bin/pg*",
		"/bin/postgres",
		"/bin/postmaster",
		"/bin/psql",
		"/bin/reindexdb",
		"/bin/vacuumdb",
		"/share/info",
		"/share/man",
		"/share/postgresql",
		"/include",
		"*.a",
		"*.la"
	],
	"build-options": {
		"no-debuginfo": true,
		"strip": true,
		"prefix": "/usr/lib/sdk/php74",
		"prepend-path": "/usr/lib/sdk/php74/bin",
		"prepend-ld-library-path": "/usr/lib/sdk/php74/lib",
		"append-pkg-config-path": "/usr/lib/sdk/php74/lib/pkgconfig",
		"env": {
			"PHP_INI_DIR": "/usr/lib/sdk/php74/etc/php"
		}
	},
	"modules": [
		{
			"name": "libldap",
			"buildsystem": "autotools",
			"config-opts": [
				"--disable-slapd",
				"--disable-static"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://www.openldap.org/software/download/OpenLDAP/openldap-release/openldap-2.4.56.tgz",
					"sha256": "25520e0363c93f3bcb89802a4aa3db33046206039436e0c7c9262db5a61115e0"
				}
			],
			"post-install": [
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/libldap/LICENSE"
			]
		},
		{
			"name": "libpq",
			"buildsystem": "simple",
			"build-commands": [
				"./configure --prefix=${FLATPAK_DEST} --disable-rpath --with-openssl --without-readline",
				"cd src/interfaces/libpq",
				"make -j$FLATPAK_BUILDER_N_JOBS",
				"make install"
			],
			"sources":[
				{
					"type": "archive",
					"url": "https://ftp.postgresql.org/pub/source/v13.1/postgresql-13.1.tar.bz2",
					"sha256": "12345c83b89aa29808568977f5200d6da00f88a035517f925293355432ffe61f"
				}
			],
			"post-install": [
				"install -Dm644 COPYRIGHT ${FLATPAK_DEST}/share/licenses/libpq/LICENSE"
			]
		},
		{
			"name": "libzip",
			"buildsystem": "cmake-ninja",
			"config-opts": [
				"-DBUILD_TOOLS=OFF",
				"-DBUILD_EXAMPLES=OFF",
				"-DBUILD_DOC=OFF"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://libzip.org/download/libzip-1.7.3.tar.xz",
					"sha256": "a60473ffdb7b4260c08bfa19c2ccea0438edac11193c3afbbb1f17fbcf6c6132"
				}
			],
			"post-install": [
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/libzip/LICENSE"
			]
		},
		{
			"name": "libsodium",
			"buildsystem": "autotools",
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/jedisct1/libsodium.git",
					"branch": "stable",
					"commit": "a08a945c589462f524efddbc8d62427bb002bb6a"
				}
			],
			"post-install": [
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/libsodium/LICENSE"
			]
		},
		{
			"name": "libargon2",
			"buildsystem": "simple",
			"build-commands": [
				"PREFIX=${FLATPAK_DEST} LIBRARY_REL=lib make -j$FLATPAK_BUILDER_N_JOBS",
				"PREFIX=${FLATPAK_DEST} LIBRARY_REL=lib make install"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/P-H-C/phc-winner-argon2.git",
					"tag": "20190702",
					"commit": "62358ba2123abd17fccf2a108a301d4b52c01a7c"
				}
			],
			"post-install": [
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/libargon2/LICENSE"
			]
		},
		{
			"name": "php",
			"buildsystem": "autotools",
			"config-opts": [
				"--enable-option-checking=fatal",
				"--with-config-file-path=/usr/lib/sdk/php74/etc/php",
				"--with-config-file-scan-dir=/usr/lib/sdk/php74/etc/php/conf.d:/app/etc/php:/var/config/php/7.4/ini",
				"--disable-cgi",
				"--enable-bcmath",
				"--enable-calendar",
				"--enable-dba=shared",
				"--enable-exif",
				"--enable-ftp",
				"--enable-gd",
				"--enable-gd-jis-conv",
				"--with-freetype",
				"--with-jpeg",
				"--with-webp",
				"--with-xpm",
				"--enable-intl",
				"--enable-mbstring",
				"--enable-opcache",
				"--enable-pcntl",
				"--enable-phpdbg",
				"--enable-re2c-cgoto",
				"--enable-sockets",
				"--enable-sysvmsg",
				"--enable-sysvsem",
				"--enable-sysvshm",
				"--with-bz2",
				"--with-curl",
				"--with-ffi",
				"--with-gettext",
				"--with-ldap=/usr/lib/sdk/php74",
				"--with-mhash",
				"--with-mysqli",
				"--with-openssl",
				"--with-password-argon2=/usr/lib/sdk/php74",
				"--with-pdo-mysql",
				"--with-pdo-pgsql=/usr/lib/sdk/php74",
				"--with-pdo-sqlite",
				"--with-pspell",
				"--with-readline",
				"--with-sodium",
				"--with-sqlite3",
				"--with-xmlrpc",
				"--with-xsl",
				"--with-zip",
				"--with-zlib"
			],
			"post-install": [
				"install -Dm644 php.ini-development ${PHP_INI_DIR}/php.ini",
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/php/LICENSE"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://www.php.net/distributions/php-7.4.13.tar.xz",
					"sha256": "aead303e3abac23106529560547baebbedba0bb2943b91d5aa08fff1f41680f4"
				}
			]
		},
		{
			"name": "apcu",
			"buildsystem": "autotools",
			"config-opts": [
				"--with-php-config=/usr/lib/sdk/php74/bin/php-config"
			],
			"post-install": [
				"install -Dm755 modules/apcu.so $(php -r 'echo ini_get(\"extension_dir\");')/apcu.so",
				"install -Dm644 apcu.ini ${PHP_INI_DIR}/conf.d/apcu.ini",
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/apcu/LICENSE"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://github.com/krakjoe/apcu/archive/v5.1.19.tar.gz",
					"sha256": "b4e374b424566d3561c23335f25d907349ee01971ee3210a99073bec2a00528b"
				},
				{
					"type":"file",
					"path":"apcu.ini"
				},
				{
					"type": "shell",
					"commands": [
						"${FLATPAK_DEST}/bin/phpize"
					]
				}
			]
		},
		{
			"name":"xdebug",
			"buildsystem":"autotools",
			"config-opts": [
				"--with-php-config=/usr/lib/sdk/php74/bin/php-config"
			],
			"post-install": [
				"install -Dm755 modules/xdebug.so $(php -r 'echo ini_get(\"extension_dir\");')/xdebug.so",
				"install -Dm644 xdebug.ini ${PHP_INI_DIR}/conf.d/xdebug.ini",
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/xdebug/LICENSE"
			],
			"sources":[
				{
					"type":"archive",
					"url":"https://xdebug.org/files/xdebug-3.0.1.tgz",
					"sha256":"0b95317153a2254f3da1fc9010fdffc40c9eec232be3ede088ec4c9bd94049b5"
				},
				{
					"type":"file",
					"path":"xdebug.ini"
				},
				{
					"type": "shell",
					"commands": [
						"${FLATPAK_DEST}/bin/phpize"
					]
				}
			]
		},
		{
			"name": "composer",
			"buildsystem": "simple",
			"build-commands": [
				"install -Dm755 composer.phar ${FLATPAK_DEST}/bin/composer",
				"install -Dm644 LICENSE ${FLATPAK_DEST}/share/licenses/composer/LICENSE"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://getcomposer.org/download/2.0.8/composer.phar",
					"sha256": "2021f0d52b446e0efe3c548cc058ab5671fa38cdbcf814e7911c7e9d71d61538"
				},
				{
					"type": "git",
					"url": "https://github.com/composer/composer.git",
					"tag": "2.0.8",
					"commit": "62139b2806178adb979d76bd3437534a1a9fd490"
				}
			]
		},
		{
			"name": "phive",
			"buildsystem": "simple",
			"build-commands": [
				"install -Dm0755 phive.phar ${FLATPAK_DEST}/bin/phive",
				"install -Dm0644 LICENSE ${FLATPAK_DEST}/share/licenses/phive/LICENSE"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://github.com/phar-io/phive/releases/download/0.14.5/phive-0.14.5.phar",
					"sha256": "70d6de4afb2e4f66ff06e35434299f2a1d81d7ea3fec9c3359adb521c196ff8d",
					"dest-filename": "phive.phar"
				},
				{
					"type": "git",
					"url": "https://github.com/phar-io/phive.git",
					"tag": "0.14.5",
					"commit": "6d56d00efc22db8eb6fc87e0dfafa85e689f37d7"
				}
			]
		},
		{
			"name": "scripts",
			"buildsystem": "simple",
			"build-commands": [
				"cp {enable,install{,-sdk}}.sh ${FLATPAK_DEST}",
				"install -Dm0644 ${FLATPAK_ID}.metainfo.xml ${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.metainfo.xml",
				"appstream-compose --basename=${FLATPAK_ID} --prefix=${FLATPAK_DEST} --origin=flatpak ${FLATPAK_ID}"
			],
			"sources": [
				{
					"type": "script",
					"dest-filename": "install.sh",
					"commands": [
						"install -Dm0755 /usr/lib/sdk/php74/bin/php ${FLATPAK_DEST}/php74/bin/php",
						"install -Dm0755 /usr/lib/sdk/php74/bin/phpdbg ${FLATPAK_DEST}/php74/bin/phpdbg",
						"install -Dm0755 /usr/lib/sdk/php74/bin/composer ${FLATPAK_DEST}/php74/bin/composer"
					]
				},
				{
					"type": "script",
					"dest-filename": "install-sdk.sh",
					"commands": [
						"cp -r /usr/lib/sdk/php74 ${FLATPAK_DEST}/php74"
					]
				},
				{
					"type": "script",
					"dest-filename": "enable.sh",
					"commands": [
						"export PATH=$PATH:/usr/lib/sdk/php74/bin:/var/config/composer/vendor/bin"
					]
				},
				{
					"type": "file",
					"path": "org.freedesktop.Sdk.Extension.php74.metainfo.xml"
				}
			]
		}
	]
}



